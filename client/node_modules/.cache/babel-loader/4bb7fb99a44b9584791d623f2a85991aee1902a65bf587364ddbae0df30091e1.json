{"ast":null,"code":"import React from\"react\";import{Navigate,useNavigate}from\"react-router-dom\";import{useEffect}from\"react\";import{useDispatch,useSelector}from\"react-redux\";import axios from\"axios\";import{setUser}from\"../redux/userSlice\";import{hideLoading,showLoading}from\"../redux/alertSlice\";import{jsx as _jsx}from\"react/jsx-runtime\";function ProtectedRoute(props){const{user}=useSelector(state=>state.user);const dispatch=useDispatch();const navigate=useNavigate;const getUser=async()=>{try{dispatch(showLoading());const response=await axios.post(\"https://stayfit-fr11.onrender.com/api/user/get-user-info-by-id\",{token:localStorage.getItem(\"token\")},{headers:{Authorization:\"Bearer \".concat(localStorage.getItem(\"token\"))}});dispatch(hideLoading());if(response.data.success){dispatch(setUser(response.data.data));}else{localStorage.clear();navigate(\"/login\");}}catch(error){dispatch(hideLoading());localStorage.clear();navigate(\"/login\");}};useEffect(()=>{if(!user){getUser();}},[user]);if(localStorage.getItem(\"token\")){return props.children;}else{return/*#__PURE__*/_jsx(Navigate,{to:\"/login\"});}}export default ProtectedRoute;","map":{"version":3,"names":["React","Navigate","useNavigate","useEffect","useDispatch","useSelector","axios","setUser","hideLoading","showLoading","jsx","_jsx","ProtectedRoute","props","user","state","dispatch","navigate","getUser","response","post","token","localStorage","getItem","headers","Authorization","concat","data","success","clear","error","children","to"],"sources":["E:/Projects/Stayfit/client/src/components/ProtectedRoute.js"],"sourcesContent":["import React from \"react\";\r\nimport { Navigate, useNavigate } from \"react-router-dom\";\r\nimport { useEffect } from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport axios from \"axios\";\r\nimport { setUser } from \"../redux/userSlice\";\r\nimport { hideLoading, showLoading } from \"../redux/alertSlice\";\r\n\r\nfunction ProtectedRoute(props) {\r\n  const { user } = useSelector((state) => state.user);\r\n  const dispatch = useDispatch();\r\n  const navigate = useNavigate;\r\n  const getUser = async () => {\r\n    try {\r\n      dispatch(showLoading());\r\n      const response = await axios.post(\r\n        \"https://stayfit-fr11.onrender.com/api/user/get-user-info-by-id\",\r\n        {\r\n          token: localStorage.getItem(\"token\"),\r\n        },\r\n        {\r\n          headers: {\r\n            Authorization: `Bearer ${localStorage.getItem(\"token\")}`,\r\n          },\r\n        }\r\n      );\r\n      dispatch(hideLoading());\r\n      if (response.data.success) {\r\n        dispatch(setUser(response.data.data));\r\n      } else {\r\n        localStorage.clear();\r\n        navigate(\"/login\");\r\n      }\r\n    } catch (error) {\r\n      dispatch(hideLoading());\r\n      localStorage.clear();\r\n      navigate(\"/login\");\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (!user) {\r\n      getUser();\r\n    }\r\n  }, [user]);\r\n\r\n  if (localStorage.getItem(\"token\")) {\r\n    return props.children;\r\n  } else {\r\n    return <Navigate to=\"/login\" />;\r\n  }\r\n}\r\n\r\nexport default ProtectedRoute;\r\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,KAAM,OAAO,CACzB,OAASC,QAAQ,CAAEC,WAAW,KAAQ,kBAAkB,CACxD,OAASC,SAAS,KAAQ,OAAO,CACjC,OAASC,WAAW,CAAEC,WAAW,KAAQ,aAAa,CACtD,MAAO,CAAAC,KAAK,KAAM,OAAO,CACzB,OAASC,OAAO,KAAQ,oBAAoB,CAC5C,OAASC,WAAW,CAAEC,WAAW,KAAQ,qBAAqB,CAAC,OAAAC,GAAA,IAAAC,IAAA,yBAE/D,QAAS,CAAAC,cAAcA,CAACC,KAAK,CAAE,CAC7B,KAAM,CAAEC,IAAK,CAAC,CAAGT,WAAW,CAAEU,KAAK,EAAKA,KAAK,CAACD,IAAI,CAAC,CACnD,KAAM,CAAAE,QAAQ,CAAGZ,WAAW,CAAC,CAAC,CAC9B,KAAM,CAAAa,QAAQ,CAAGf,WAAW,CAC5B,KAAM,CAAAgB,OAAO,CAAG,KAAAA,CAAA,GAAY,CAC1B,GAAI,CACFF,QAAQ,CAACP,WAAW,CAAC,CAAC,CAAC,CACvB,KAAM,CAAAU,QAAQ,CAAG,KAAM,CAAAb,KAAK,CAACc,IAAI,CAC/B,gEAAgE,CAChE,CACEC,KAAK,CAAEC,YAAY,CAACC,OAAO,CAAC,OAAO,CACrC,CAAC,CACD,CACEC,OAAO,CAAE,CACPC,aAAa,WAAAC,MAAA,CAAYJ,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CACxD,CACF,CACF,CAAC,CACDP,QAAQ,CAACR,WAAW,CAAC,CAAC,CAAC,CACvB,GAAIW,QAAQ,CAACQ,IAAI,CAACC,OAAO,CAAE,CACzBZ,QAAQ,CAACT,OAAO,CAACY,QAAQ,CAACQ,IAAI,CAACA,IAAI,CAAC,CAAC,CACvC,CAAC,IAAM,CACLL,YAAY,CAACO,KAAK,CAAC,CAAC,CACpBZ,QAAQ,CAAC,QAAQ,CAAC,CACpB,CACF,CAAE,MAAOa,KAAK,CAAE,CACdd,QAAQ,CAACR,WAAW,CAAC,CAAC,CAAC,CACvBc,YAAY,CAACO,KAAK,CAAC,CAAC,CACpBZ,QAAQ,CAAC,QAAQ,CAAC,CACpB,CACF,CAAC,CAEDd,SAAS,CAAC,IAAM,CACd,GAAI,CAACW,IAAI,CAAE,CACTI,OAAO,CAAC,CAAC,CACX,CACF,CAAC,CAAE,CAACJ,IAAI,CAAC,CAAC,CAEV,GAAIQ,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAAE,CACjC,MAAO,CAAAV,KAAK,CAACkB,QAAQ,CACvB,CAAC,IAAM,CACL,mBAAOpB,IAAA,CAACV,QAAQ,EAAC+B,EAAE,CAAC,QAAQ,CAAE,CAAC,CACjC,CACF,CAEA,cAAe,CAAApB,cAAc"},"metadata":{},"sourceType":"module","externalDependencies":[]}