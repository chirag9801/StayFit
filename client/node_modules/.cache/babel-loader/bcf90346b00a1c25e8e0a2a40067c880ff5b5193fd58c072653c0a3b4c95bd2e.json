{"ast":null,"code":"import{Tabs}from\"antd\";import toast from\"react-hot-toast\";import axios from\"axios\";import Layout from\"../components/Layout\";import React from\"react\";import{useDispatch,useSelector}from\"react-redux\";import{useNavigate}from\"react-router-dom\";import{showLoading,hideLoading}from\"../redux/alertSlice\";import{setUser}from\"../redux/userSlice\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Messages(){const{user}=useSelector(state=>state.user);const navigate=useNavigate();const dispatch=useDispatch();const markAllAsSeen=async()=>{try{dispatch(showLoading());const response=await axios.post(\"https://stayfit-fr11.onrender.com/api/user/mark-all-notification-as-seen\",{userId:user._id},{headers:{Authorization:\"Bearer \".concat(localStorage.getItem(\"token\"))}});dispatch(hideLoading());if(response.data.success){toast.success(response.data.message);dispatch(setUser(response.data.data));}else{toast.error(response.data.message);}}catch(error){toast.error(\"something went wrong\");}};const deleteAll=async()=>{try{dispatch(showLoading());const response=await axios.post(\"http://localhost:5000/api/user/delete-all-messages\",{userId:user._id},{headers:{Authorization:\"Bearer \".concat(localStorage.getItem(\"token\"))}});dispatch(hideLoading());if(response.data.success){toast.success(response.data.message);dispatch(setUser(response.data.data));}else{toast.error(response.data.message);}}catch(error){toast.error(\"something went wrong\");}};return/*#__PURE__*/_jsxs(Layout,{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"page-title\",children:\"Notifications\"}),/*#__PURE__*/_jsx(Tabs,{defaultActiveKey:\"1\",items:[{label:\"Unseen\",key:\"1\",children:/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"d-flex justify-content-end\",children:/*#__PURE__*/_jsx(\"h1\",{className:\"anchor\",onClick:()=>markAllAsSeen(),children:\"Mark all as seen\"})}),user===null||user===void 0?void 0:user.unseenMessage.map(notify=>/*#__PURE__*/_jsx(\"div\",{className:\"card p-2\",onClick:()=>navigate(notify.onClickPath),children:/*#__PURE__*/_jsx(\"div\",{className:\"card-text\",children:notify.message})}))]})},{label:\"Seen\",key:\"2\",children:/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"d-flex justify-content-end\",children:/*#__PURE__*/_jsx(\"h1\",{className:\"anchor\",onClick:()=>deleteAll(),children:\"Delete all\"})}),user===null||user===void 0?void 0:user.seenMessage.map(notify=>/*#__PURE__*/_jsx(\"div\",{className:\"card p-2\",onClick:()=>navigate(notify.onClickPath),children:/*#__PURE__*/_jsx(\"div\",{className:\"card-text\",children:notify.message})}))]})}]})]});}export default Messages;","map":{"version":3,"names":["Tabs","toast","axios","Layout","React","useDispatch","useSelector","useNavigate","showLoading","hideLoading","setUser","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","Messages","user","state","navigate","dispatch","markAllAsSeen","response","post","userId","_id","headers","Authorization","concat","localStorage","getItem","data","success","message","error","deleteAll","children","className","defaultActiveKey","items","label","key","onClick","unseenMessage","map","notify","onClickPath","seenMessage"],"sources":["E:/Projects/Stayfit/client/src/pages/Messages.js"],"sourcesContent":["import { Tabs } from \"antd\";\r\nimport toast from \"react-hot-toast\";\r\nimport axios from \"axios\";\r\nimport Layout from \"../components/Layout\";\r\nimport React from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport { showLoading, hideLoading } from \"../redux/alertSlice\";\r\nimport { setUser } from \"../redux/userSlice\";\r\n\r\nfunction Messages() {\r\n  const { user } = useSelector((state) => state.user);\r\n  const navigate = useNavigate();\r\n  const dispatch = useDispatch();\r\n\r\n  const markAllAsSeen = async () => {\r\n    try {\r\n      dispatch(showLoading());\r\n      const response = await axios.post(\r\n        \"https://stayfit-fr11.onrender.com/api/user/mark-all-notification-as-seen\",\r\n        { userId: user._id },\r\n        {\r\n          headers: {\r\n            Authorization: `Bearer ${localStorage.getItem(\"token\")}`,\r\n          },\r\n        }\r\n      );\r\n      dispatch(hideLoading());\r\n      if (response.data.success) {\r\n        toast.success(response.data.message);\r\n        dispatch(setUser(response.data.data));\r\n      } else {\r\n        toast.error(response.data.message);\r\n      }\r\n    } catch (error) {\r\n      toast.error(\"something went wrong\");\r\n    }\r\n  };\r\n\r\n  const deleteAll = async () => {\r\n    try {\r\n      dispatch(showLoading());\r\n      const response = await axios.post(\r\n        \"http://localhost:5000/api/user/delete-all-messages\",\r\n        { userId: user._id },\r\n        {\r\n          headers: {\r\n            Authorization: `Bearer ${localStorage.getItem(\"token\")}`,\r\n          },\r\n        }\r\n      );\r\n      dispatch(hideLoading());\r\n      if (response.data.success) {\r\n        toast.success(response.data.message);\r\n        dispatch(setUser(response.data.data));\r\n      } else {\r\n        toast.error(response.data.message);\r\n      }\r\n    } catch (error) {\r\n      toast.error(\"something went wrong\");\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Layout>\r\n      <h1 className=\"page-title\">Notifications</h1>\r\n\r\n      <Tabs\r\n        defaultActiveKey=\"1\"\r\n        items={[\r\n          {\r\n            label: \"Unseen\",\r\n            key: \"1\",\r\n            children: (\r\n              <>\r\n                <div className=\"d-flex justify-content-end\">\r\n                  <h1 className=\"anchor\" onClick={() => markAllAsSeen()}>\r\n                    Mark all as seen\r\n                  </h1>\r\n                </div>\r\n\r\n                {user?.unseenMessage.map((notify) => (\r\n                  <div\r\n                    className=\"card p-2\"\r\n                    onClick={() => navigate(notify.onClickPath)}\r\n                  >\r\n                    <div className=\"card-text\">{notify.message}</div>\r\n                  </div>\r\n                ))}\r\n              </>\r\n            ),\r\n          },\r\n          {\r\n            label: \"Seen\",\r\n            key: \"2\",\r\n            children: (\r\n              <>\r\n                <div className=\"d-flex justify-content-end\">\r\n                  <h1 className=\"anchor\" onClick={() => deleteAll()}>\r\n                    Delete all\r\n                  </h1>\r\n                </div>\r\n                {user?.seenMessage.map((notify) => (\r\n                  <div\r\n                    className=\"card p-2\"\r\n                    onClick={() => navigate(notify.onClickPath)}\r\n                  >\r\n                    <div className=\"card-text\">{notify.message}</div>\r\n                  </div>\r\n                ))}\r\n              </>\r\n            ),\r\n          },\r\n        ]}\r\n      />\r\n    </Layout>\r\n  );\r\n}\r\n\r\nexport default Messages;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}